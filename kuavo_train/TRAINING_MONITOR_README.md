# è®­ç»ƒç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—

æœ¬é¡¹ç›®æä¾›äº†ä¸¤ä¸ªè®­ç»ƒç›‘æ§è„šæœ¬ï¼Œç”¨äºå®æ—¶ç›‘æ§å’Œåˆ†ææ¨¡å‹è®­ç»ƒè¿‡ç¨‹ã€‚

## ğŸ“‹ ç›®å½•

1. [å·¥å…·æ¦‚è¿°](#å·¥å…·æ¦‚è¿°)
2. [å®‰è£…ä¾èµ–](#å®‰è£…ä¾èµ–)
3. [åŸºç¡€ç›‘æ§å™¨](#åŸºç¡€ç›‘æ§å™¨)
4. [é«˜çº§ç›‘æ§å™¨](#é«˜çº§ç›‘æ§å™¨)
5. [å¸¸è§ä½¿ç”¨åœºæ™¯](#å¸¸è§ä½¿ç”¨åœºæ™¯)
6. [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)

---

## ğŸ¯ å·¥å…·æ¦‚è¿°

### 1. `monitor_training.py` - åŸºç¡€ç›‘æ§å™¨

**ç‰¹ç‚¹ï¼š**
- âœ… è½»é‡çº§ï¼Œä¾èµ–å°‘
- âœ… å¿«é€ŸæŸ¥çœ‹è®­ç»ƒçŠ¶æ€
- âœ… ç”Ÿæˆè®­ç»ƒæŠ¥å‘Š
- âœ… åŸºç¡€å¯è§†åŒ–å›¾è¡¨

**é€‚ç”¨åœºæ™¯ï¼š**
- å¿«é€Ÿæ£€æŸ¥è®­ç»ƒè¿›åº¦
- ç”Ÿæˆè®­ç»ƒæŠ¥å‘Š
- èµ„æºå—é™ç¯å¢ƒ

### 2. `monitor_training_advanced.py` - é«˜çº§ç›‘æ§å™¨

**ç‰¹ç‚¹ï¼š**
- ğŸš€ å®æ—¶äº¤äº’å¼ç•Œé¢
- ğŸ“Š ä¸°å¯Œçš„å¯è§†åŒ–ä»ªè¡¨æ¿
- ğŸ¯ GPU/ç³»ç»Ÿèµ„æºç›‘æ§
- ğŸ¥ è®­ç»ƒå¥åº·åº¦è¯„åˆ†
- ğŸ” è‡ªåŠ¨å¼‚å¸¸æ£€æµ‹

**é€‚ç”¨åœºæ™¯ï¼š**
- é•¿æ—¶é—´è®­ç»ƒç›‘æ§
- è¯¦ç»†æ€§èƒ½åˆ†æ
- å¤šæŒ‡æ ‡å¯¹æ¯”åˆ†æ
- GPUèµ„æºä¼˜åŒ–

---

## ğŸ“¦ å®‰è£…ä¾èµ–

### åŸºç¡€ç›‘æ§å™¨ä¾èµ–

```bash
# æœ€å°ä¾èµ–
pip install tensorboard

# å¯é€‰ï¼šå›¾è¡¨åŠŸèƒ½
pip install matplotlib
```

### é«˜çº§ç›‘æ§å™¨ä¾èµ–

```bash
# å®Œæ•´ä¾èµ–
pip install tensorboard rich matplotlib psutil GPUtil

# æˆ–è€…åˆ†åˆ«å®‰è£…
pip install tensorboard  # TensorBoardäº‹ä»¶è§£æ
pip install rich         # ç¾åŒ–ç»ˆç«¯ç•Œé¢
pip install matplotlib   # å›¾è¡¨ç»˜åˆ¶
pip install psutil       # ç³»ç»Ÿç›‘æ§
pip install gputil       # GPUç›‘æ§ï¼ˆNVIDIAï¼‰
```

### å¿«é€Ÿå®‰è£…

```bash
# å®‰è£…æ‰€æœ‰ç›‘æ§å·¥å…·ä¾èµ–
cd /Users/HarowrdLiu/learn/robot/kuavo_data_challenge
pip install tensorboard rich matplotlib psutil GPUtil
```

---

## ğŸ”§ åŸºç¡€ç›‘æ§å™¨

### åŸºæœ¬ç”¨æ³•

```bash
# 1. è‡ªåŠ¨æ‰¾åˆ°æœ€æ–°çš„è®­ç»ƒè¿è¡Œå¹¶ç›‘æ§
python kuavo_train/monitor_training.py

# 2. ç›‘æ§æŒ‡å®šçš„è®­ç»ƒè¿è¡Œ
python kuavo_train/monitor_training.py --run-dir outputs/train/task1_moving_grasp/smolvla_sequential/run_20251017_120000

# 3. è‡ªåŠ¨åˆ·æ–°æ¨¡å¼ï¼ˆæ¯5ç§’æ›´æ–°ï¼‰
python kuavo_train/monitor_training.py --refresh 5

# 4. æ˜¾ç¤ºå¯è§†åŒ–å›¾è¡¨
python kuavo_train/monitor_training.py --plot

# 5. ä¿å­˜è®­ç»ƒæŠ¥å‘Š
python kuavo_train/monitor_training.py --save-report
```

### è¾“å‡ºç¤ºä¾‹

```
================================================================================
ğŸ¤– è®­ç»ƒç›‘æ§å™¨
================================================================================
ğŸ“ è¿è¡Œç›®å½•: outputs/train/task1_moving_grasp/smolvla_sequential/run_20251017_120000
ğŸ• æ›´æ–°æ—¶é—´: 2025-10-17 14:30:25
================================================================================

ğŸ“Š è®­ç»ƒè¿›åº¦:
--------------------------------------------------------------------------------
å½“å‰Epoch: 15
è®­ç»ƒLoss: 0.023456 ğŸ“‰ (-5.23%)
å­¦ä¹ ç‡: 1.25e-04
Epochè€—æ—¶: 3.45åˆ†é’Ÿ
é¢„è®¡å‰©ä½™æ—¶é—´: 120.8åˆ†é’Ÿ (2.0å°æ—¶)

ğŸ“ˆ éªŒè¯æŒ‡æ ‡:
--------------------------------------------------------------------------------
task1_moving_grasp_loss: 0.025123

ğŸ“‰ Lossè¶‹åŠ¿ (æœ€è¿‘10ä¸ªepoch):
--------------------------------------------------------------------------------
Epoch  11: 0.028934 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
Epoch  12: 0.026821 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
Epoch  13: 0.025234 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
Epoch  14: 0.024567 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
Epoch  15: 0.023456 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ

ğŸ’¾ CheckpointçŠ¶æ€:
--------------------------------------------------------------------------------
æœ€ä½³æ¨¡å‹: âœ… å·²ä¿å­˜
å·²ä¿å­˜Epoch: 5, 10, 15
æœ€æ–°Epoch: 15

ğŸ” è®­ç»ƒçŠ¶æ€è¯„ä¼°:
--------------------------------------------------------------------------------
çŠ¶æ€: æ­£å¸¸ä¸‹é™
```

---

## ğŸš€ é«˜çº§ç›‘æ§å™¨

### åŸºæœ¬ç”¨æ³•

```bash
# 1. å¯åŠ¨ç»ˆç«¯ä»ªè¡¨æ¿ï¼ˆé»˜è®¤ï¼‰
python kuavo_train/monitor_training_advanced.py

# 2. å¯åŠ¨å®æ—¶å›¾è¡¨æ¨¡å¼
python kuavo_train/monitor_training_advanced.py --mode plot

# 3. å¯ç”¨GPUç›‘æ§
python kuavo_train/monitor_training_advanced.py --monitor-gpu

# 4. è‡ªå®šä¹‰åˆ·æ–°é—´éš”
python kuavo_train/monitor_training_advanced.py --refresh 10

# 5. ç›‘æ§æŒ‡å®šç›®å½•ï¼ˆå¸¦GPUç›‘æ§ï¼‰
python kuavo_train/monitor_training_advanced.py \
    --run-dir outputs/train/task1_moving_grasp/smolvla_sequential/run_20251017_120000 \
    --monitor-gpu \
    --mode plot
```

### ä»ªè¡¨æ¿ç•Œé¢

é«˜çº§ç›‘æ§å™¨æä¾›å®æ—¶äº¤äº’å¼ä»ªè¡¨æ¿ï¼ŒåŒ…å«ï¼š

1. **è®­ç»ƒæŒ‡æ ‡é¢æ¿**
   - å½“å‰Loss
   - å­¦ä¹ ç‡
   - Epochè€—æ—¶

2. **è®­ç»ƒçŠ¶æ€é¢æ¿**
   - å¥åº·åº¦è¯„åˆ†ï¼ˆ0-100ï¼‰
   - å¼‚å¸¸å‘Šè­¦
   - ä¼˜åŒ–å»ºè®®

3. **èµ„æºä½¿ç”¨é¢æ¿**
   - GPUä½¿ç”¨ç‡ã€æ˜¾å­˜ã€æ¸©åº¦
   - CPUä½¿ç”¨ç‡
   - å†…å­˜ä½¿ç”¨ç‡

4. **Checkpointé¢æ¿**
   - æœ€ä½³æ¨¡å‹çŠ¶æ€
   - å·²ä¿å­˜çš„Epochåˆ—è¡¨

### å›¾è¡¨æ¨¡å¼

å¯åŠ¨å›¾è¡¨æ¨¡å¼åï¼Œå°†æ˜¾ç¤º6ä¸ªå®æ—¶æ›´æ–°çš„å›¾è¡¨ï¼š

1. **è®­ç»ƒLosså˜åŒ–** - æ˜¾ç¤ºlossä¸‹é™è¶‹åŠ¿
2. **å­¦ä¹ ç‡å˜åŒ–** - ç›‘æ§å­¦ä¹ ç‡è°ƒåº¦
3. **Epochè®­ç»ƒæ—¶é—´** - åˆ†æè®­ç»ƒæ•ˆç‡
4. **GPUä½¿ç”¨ç‡** - ä¼˜åŒ–èµ„æºåˆ©ç”¨
5. **è®­ç»ƒå¥åº·åº¦** - ç»¼åˆè¯„ä¼°è®­ç»ƒçŠ¶æ€
6. **éªŒè¯Loss** - å¤šä»»åŠ¡éªŒè¯å¯¹æ¯”

---

## ğŸ’¡ å¸¸è§ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šå¿«é€Ÿæ£€æŸ¥è®­ç»ƒæ˜¯å¦æ­£å¸¸

```bash
# æŸ¥çœ‹æœ€æ–°è®­ç»ƒçš„çŠ¶æ€
python kuavo_train/monitor_training.py

# å¦‚æœçœ‹åˆ°"æ­£å¸¸ä¸‹é™"ï¼Œè¯´æ˜è®­ç»ƒæ­£å¸¸
# å¦‚æœçœ‹åˆ°è­¦å‘Šï¼Œæ ¹æ®å»ºè®®è°ƒæ•´
```

### åœºæ™¯2ï¼šé•¿æ—¶é—´è®­ç»ƒæŒç»­ç›‘æ§

```bash
# å¯åŠ¨é«˜çº§ç›‘æ§å™¨ï¼Œè‡ªåŠ¨åˆ·æ–°
python kuavo_train/monitor_training_advanced.py --monitor-gpu

# è®©å®ƒåœ¨åå°è¿è¡Œï¼Œå®šæœŸæŸ¥çœ‹å³å¯
# æŒ‰Ctrl+Cé€€å‡º
```

### åœºæ™¯3ï¼šè®­ç»ƒç»“æŸååˆ†æ

```bash
# ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š
python kuavo_train/monitor_training.py \
    --run-dir outputs/train/task1_moving_grasp/smolvla_sequential/run_20251017_120000 \
    --save-report \
    --plot

# è¿™ä¼šç”Ÿæˆï¼š
# 1. è®­ç»ƒæŠ¥å‘Šæ–‡æœ¬æ–‡ä»¶
# 2. Loss/LRç­‰æŒ‡æ ‡çš„å›¾è¡¨
```

### åœºæ™¯4ï¼šå¯¹æ¯”ä¸åŒè®­ç»ƒè¿è¡Œ

```bash
# åˆ†åˆ«æŸ¥çœ‹ä¸åŒè®­ç»ƒçš„lossæ›²çº¿
python kuavo_train/monitor_training.py --run-dir run1 --plot
python kuavo_train/monitor_training.py --run-dir run2 --plot

# å¯¹æ¯”å›¾è¡¨ï¼Œé€‰æ‹©æœ€ä¼˜é…ç½®
```

### åœºæ™¯5ï¼šGPUåˆ©ç”¨ç‡ä¼˜åŒ–

```bash
# å¯åŠ¨GPUç›‘æ§
python kuavo_train/monitor_training_advanced.py --monitor-gpu --mode plot

# æŸ¥çœ‹GPUä½¿ç”¨ç‡å›¾è¡¨
# - å¦‚æœGPUåˆ©ç”¨ç‡<50%ï¼Œå¯ä»¥å¢åŠ batch size
# - å¦‚æœGPUåˆ©ç”¨ç‡æ¥è¿‘100%ï¼Œè¯´æ˜èµ„æºåˆ©ç”¨å……åˆ†
```

---

## ğŸ” å…³é”®æŒ‡æ ‡è§£è¯»

### è®­ç»ƒLoss

- **æ­£å¸¸ä¸‹é™**: LossæŒç»­å‡å°ï¼Œè®­ç»ƒæ­£å¸¸
- **éœ‡è¡**: Lossä¸Šä¸‹æ³¢åŠ¨ï¼Œå¯èƒ½éœ€è¦é™ä½å­¦ä¹ ç‡
- **ä¸å˜**: Lossä¸å†ä¸‹é™ï¼Œå¯èƒ½å·²æ”¶æ•›æˆ–å­¦ä¹ ç‡è¿‡å°
- **ä¸Šå‡**: Losså¢å¤§ï¼Œå¯èƒ½å­¦ä¹ ç‡è¿‡å¤§æˆ–æ•°æ®æœ‰é—®é¢˜

### å­¦ä¹ ç‡

- **æ¨èèŒƒå›´**: 1e-5 åˆ° 1e-3
- **è¿‡å°** (<1e-7): è®­ç»ƒé€Ÿåº¦æ…¢ï¼Œå¯èƒ½åœæ»
- **è¿‡å¤§** (>1e-2): è®­ç»ƒä¸ç¨³å®šï¼Œlosséœ‡è¡

### GPUä½¿ç”¨ç‡

- **ç›®æ ‡**: 70-95%
- **è¿‡ä½** (<50%): å¯èƒ½æ˜¯æ•°æ®åŠ è½½ç“¶é¢ˆæˆ–batch sizeå¤ªå°
- **è¿‡é«˜** (>95%): æ¥è¿‘é¥±å’Œï¼Œå¯ä»¥è€ƒè™‘å‡å°batch sizeé¿å…OOM

### å¥åº·åº¦è¯„åˆ†

- **90-100**: è®­ç»ƒçŠ¶æ€ä¼˜ç§€
- **70-89**: è®­ç»ƒæ­£å¸¸ï¼Œæœ‰å°é—®é¢˜
- **50-69**: å­˜åœ¨æ˜æ˜¾é—®é¢˜ï¼Œéœ€è¦è°ƒæ•´
- **<50**: è®­ç»ƒå¼‚å¸¸ï¼Œç«‹å³æ£€æŸ¥

---

## âš ï¸ æ•…éšœæ’é™¤

### é—®é¢˜1ï¼šæ‰¾ä¸åˆ°è®­ç»ƒæ•°æ®

**ç°è±¡ï¼š**
```
âš ï¸  æš‚æ— è®­ç»ƒæ•°æ®ï¼Œç­‰å¾…è®­ç»ƒå¼€å§‹...
```

**è§£å†³æ–¹æ³•ï¼š**
- ç¡®è®¤è®­ç»ƒè„šæœ¬æ­£åœ¨è¿è¡Œ
- æ£€æŸ¥è¾“å‡ºç›®å½•æ˜¯å¦æ­£ç¡®
- ç­‰å¾…è®­ç»ƒå®Œæˆç¬¬ä¸€ä¸ªepoch

### é—®é¢˜2ï¼šTensorBoardäº‹ä»¶åŠ è½½å¤±è´¥

**ç°è±¡ï¼š**
```
âš ï¸  æ— æ³•åŠ è½½TensorBoardäº‹ä»¶: ...
```

**è§£å†³æ–¹æ³•ï¼š**
```bash
# å®‰è£…/å‡çº§tensorboard
pip install --upgrade tensorboard

# æ£€æŸ¥eventsæ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls outputs/train/.../run_*/events.out.tfevents.*
```

### é—®é¢˜3ï¼šå›¾è¡¨æ— æ³•æ˜¾ç¤º

**ç°è±¡ï¼š**
å›¾è¡¨çª—å£æ‰“å¼€åç«‹å³å…³é—­

**è§£å†³æ–¹æ³•ï¼š**
```bash
# å®‰è£…matplotlibå’ŒTkAggåç«¯
pip install matplotlib

# macOSå¯èƒ½éœ€è¦å®‰è£…
brew install python-tk
```

### é—®é¢˜4ï¼šGPUç›‘æ§ä¸å·¥ä½œ

**ç°è±¡ï¼š**
```
âš ï¸  GPUtilæœªå®‰è£…ï¼ŒGPUç›‘æ§ä¸å¯ç”¨
```

**è§£å†³æ–¹æ³•ï¼š**
```bash
# å®‰è£…GPUtil
pip install gputil

# å¦‚æœä»ä¸å·¥ä½œï¼Œæ£€æŸ¥NVIDIAé©±åŠ¨
nvidia-smi
```

### é—®é¢˜5ï¼šæƒé™é”™è¯¯

**ç°è±¡ï¼š**
```
Permission denied: ...
```

**è§£å†³æ–¹æ³•ï¼š**
```bash
# æ£€æŸ¥æ–‡ä»¶æƒé™
ls -l outputs/train/.../

# ä¿®æ”¹æƒé™ï¼ˆå¦‚éœ€è¦ï¼‰
chmod -R 755 outputs/train/
```

---

## ğŸ“Š ç›‘æ§æŒ‡æ ‡è¯´æ˜

### TensorBoardè®°å½•çš„æŒ‡æ ‡

è®­ç»ƒè„šæœ¬ä¼šè‡ªåŠ¨è®°å½•ä»¥ä¸‹æŒ‡æ ‡åˆ°TensorBoardï¼š

| æŒ‡æ ‡åç§° | è¯´æ˜ | æ›´æ–°é¢‘ç‡ |
|---------|------|---------|
| `train/loss` | è®­ç»ƒæŸå¤± | æ¯ä¸ªepoch |
| `train/lr` | å­¦ä¹ ç‡ | æ¯ä¸ªepoch |
| `train/epoch_duration_minutes` | Epochè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰ | æ¯ä¸ªepoch |
| `validation/task{N}_loss` | ä»»åŠ¡Nçš„éªŒè¯æŸå¤± | æ ¹æ®`validation_freq_epoch`è®¾ç½® |

### ç›‘æ§å™¨è®¡ç®—çš„æŒ‡æ ‡

ç›‘æ§å™¨ä¼šé¢å¤–è®¡ç®—ï¼š

- **Losså˜åŒ–ç‡**: å½“å‰epochç›¸æ¯”ä¸Šä¸€ä¸ªepochçš„å˜åŒ–ç™¾åˆ†æ¯”
- **é¢„è®¡å‰©ä½™æ—¶é—´**: åŸºäºå¹³å‡epochæ—¶é—´å’Œå‰©ä½™epochæ•°
- **å¥åº·åº¦è¯„åˆ†**: ç»¼åˆLossè¶‹åŠ¿ã€å­¦ä¹ ç‡ã€GPUä½¿ç”¨ç­‰å› ç´ 

---

## ğŸ“ æœ€ä½³å®è·µ

1. **è®­ç»ƒå¼€å§‹æ—¶**ï¼šä½¿ç”¨åŸºç¡€ç›‘æ§å™¨å¿«é€Ÿæ£€æŸ¥
   ```bash
   python kuavo_train/monitor_training.py
   ```

2. **é•¿æ—¶é—´è®­ç»ƒ**ï¼šä½¿ç”¨é«˜çº§ç›‘æ§å™¨æŒç»­è§‚å¯Ÿ
   ```bash
   python kuavo_train/monitor_training_advanced.py --monitor-gpu --refresh 10
   ```

3. **å‘ç°å¼‚å¸¸æ—¶**ï¼šç”ŸæˆæŠ¥å‘Šå¹¶æŸ¥çœ‹å›¾è¡¨
   ```bash
   python kuavo_train/monitor_training.py --save-report --plot
   ```

4. **å®šæœŸæ£€æŸ¥**ï¼šæ¯éš”1-2å°æ—¶æ£€æŸ¥ä¸€æ¬¡è®­ç»ƒçŠ¶æ€

5. **è®­ç»ƒç»“æŸ**ï¼šä¿å­˜å®Œæ•´æŠ¥å‘Šç”¨äºåç»­åˆ†æ

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [è®­ç»ƒè„šæœ¬ä½¿ç”¨è¯´æ˜](../README.md)
- [SmolVLAè®­ç»ƒæŒ‡å—](../docs/SMOLVLA_TECHNICAL_DEEP_DIVE.md)
- [Diffusion Policyè®­ç»ƒ](../docs/README_DIFFUSION.md)

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0 (2025-10-17)
- âœ¨ é¦–æ¬¡å‘å¸ƒ
- âœ… åŸºç¡€ç›‘æ§å™¨
- âœ… é«˜çº§ç›‘æ§å™¨
- âœ… GPUç›‘æ§æ”¯æŒ
- âœ… å¥åº·åº¦è¯„åˆ†
- âœ… å®æ—¶å¯è§†åŒ–

---

## ğŸ¤ åé¦ˆä¸æ”¹è¿›

å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿æå‡ºIssueæˆ–PRï¼

