# ==================== ä»»åŠ¡3ï¼šæ—¥åŒ–äº§å“å®šå§¿æ‘†æ”¾ ====================

# ä»»åŠ¡åŸºæœ¬ä¿¡æ¯
task:
  id: 3
  name: 'placement'
  stage: 3 # Stage 3: ä»ä»»åŠ¡2æ¨¡å‹ç»§ç»­

  # ä»»åŠ¡æè¿°ï¼ˆä¸­æ–‡ï¼‰
  description: 'æœºå™¨äººä»æ‚ä¹±æ‘†æ”¾çš„æ—¥åŒ–ç“¶ä¸­éšæœºæ‹¾å–ä¸€ç“¶ï¼Œä¼ é€’è‡³å¦ä¸€åªæ‰‹åï¼Œå†æŒ‰ç…§æŒ‡å®šå§¿æ€å°†å…¶æ‘†æ”¾åœ¨ç›®æ ‡ä½ç½®ã€‚ç“¶èº«æ‘†æ”¾è¦æ±‚ï¼šç“¶å£ä½äºé»„è‰²åŒºåŸŸå¤–éƒ¨ï¼›ç“¶èº«å¤§éƒ¨åˆ†ä½äºé»„è‰²åŒºåŸŸå†…éƒ¨ï¼›ç“¶èº«æ ‡ç­¾é¢æœä¸Š'

  # Language Instructionï¼ˆè‹±æ–‡ï¼‰
  language_instruction: 'Pick up a bottle from the cluttered daily chemical bottles, transfer it to the other hand, and place it in the specified pose with the label facing up in the yellow area. Requirements: bottle mouth outside the yellow area, most of the bottle body inside the yellow area, label facing up'

  # æ•°æ®é…ç½®
  data:
    root: '/root/robot/data/task3/data/lerobot/1-400/'
    repoid: 'lerobot/task3_placement'
    episodes_to_use: [0, 199]

  # è®­ç»ƒé…ç½®
  training:
    max_epoch: 30 # ä»»åŠ¡3æœ€å¤æ‚ï¼Œéœ€è¦æ›´å¤šepochs

    # Stage 3: ä»ä»»åŠ¡2çš„æœ€ä½³checkpointç»§ç»­
    # æ ¼å¼: outputs/train/{task}/{method}/run_{timestamp}/best
    # éœ€è¦æ‰‹åŠ¨æŒ‡å®šä»»åŠ¡2çš„timestampï¼
    resume_from: 'task'
    resume_task_id: 2
    resume_path: 'outputs/train/task2_weighing/smolvla_sequential/run_XXXXXX_XXXXXX/best' # ä¿®æ”¹XXXXXXä¸ºå®é™…timestamp

    # è¿›ä¸€æ­¥é™ä½å­¦ä¹ ç‡
    policy:
      optimizer_lr: 2.5e-5 # è¿›ä¸€æ­¥é™ä½è‡³2.5e-5ï¼Œä¿æŠ¤ä»»åŠ¡1+2çŸ¥è¯†
      # åˆ†å±‚å­¦ä¹ ç‡
      vision_encoder_lr: 2e-6 # æ›´ä½çš„è§†è§‰ç¼–ç å™¨å­¦ä¹ ç‡ï¼ˆä»3e-6é™åˆ°2e-6ï¼‰
      expert_lr: 1e-5 # æ›´ä½çš„Action Expertå­¦ä¹ ç‡ï¼ˆä»1.5e-5é™åˆ°1e-5ï¼‰
      scheduler_warmup_steps: 500 # çŸ­æš‚é€‚åº”å³å¯
      scheduler_decay_steps: 25000

      # ğŸ†• ä»»åŠ¡3æ¨èçš„è§†è§‰å±‚å†»ç»“ç­–ç•¥ï¼ˆæœ€ä¿å®ˆï¼‰
      # ç›®æ ‡ï¼šå­¦ä¹ å¤æ‚çš„å§¿æ€æ‘†æ”¾ï¼ŒåŒæ—¶ä¿æŠ¤ä»»åŠ¡1+2
      # ç­–ç•¥ï¼šåªè§£å†»æœ€å5å±‚ï¼ˆæœ€æ ¸å¿ƒçš„ä»»åŠ¡ç‰¹å®šå±‚ï¼‰
      unfreeze_vision_layers: [-1, -2, -3, -4, -5] # è§£å†» Layer 22-26

      # ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªç­–ç•¥ï¼Ÿ
      # 1. é¡ºåºå­¦ä¹ çš„ç¬¬3ä¸ªä»»åŠ¡ï¼Œé—å¿˜é£é™©æœ€é«˜
      # 2. å§¿æ€æ‘†æ”¾ä¸»è¦ä¾èµ–é«˜å±‚åŠ¨ä½œè§„åˆ’ï¼Œä¸éœ€è¦æ”¹å˜åº•å±‚ç‰¹å¾
      # 3. "æ ‡ç­¾é¢æœä¸Š"éœ€è¦ç²¾ç¡®çš„æŠ“å–å’Œæ”¾ç½®ï¼Œåªéœ€è°ƒæ•´æœ€é«˜å±‚
      # 4. æœ€ä¿å®ˆç­–ç•¥ç¡®ä¿ä»»åŠ¡1å’Œä»»åŠ¡2çš„æ€§èƒ½ä¸ä¸‹é™

      # å¦‚æœä»»åŠ¡3æ•ˆæœä¸ä½³ï¼Œå¯ä»¥ç¨å¾®æ”¾å®½:
      # unfreeze_vision_layers: [-1, -2, -3, -4, -5, -6, -7]  # è§£å†»æœ€å7å±‚

      # è­¦å‘Šï¼šä¸å»ºè®®è§£å†»è¶…è¿‡10å±‚ï¼Œå¦åˆ™å¯èƒ½ä¸¥é‡é—å¿˜ä»»åŠ¡1+2

  # Replayé…ç½®
  replay:
    task1_episodes: 20 # 10% ä»»åŠ¡1
    task2_episodes: 40 # 20% ä»»åŠ¡2
    # ä»»åŠ¡3å 70%ï¼ˆç”±è®­ç»ƒè„šæœ¬è‡ªåŠ¨è®¡ç®—ï¼‰
