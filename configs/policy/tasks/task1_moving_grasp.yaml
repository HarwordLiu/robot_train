# ==================== ä»»åŠ¡1ï¼šç§»åŠ¨ç›®æ ‡æŠ“å– ====================

# ä»»åŠ¡åŸºæœ¬ä¿¡æ¯
task:
  id: 1
  name: 'moving_grasp'
  stage: 1 # Stage 1: ä»é¢„è®­ç»ƒæ¨¡å‹å¼€å§‹

  description: 'æœºå™¨äººä»ç§»åŠ¨çš„ä¼ é€å¸¦ä¸ŠæŠ“å–ç‰©ä½“ï¼Œæ”¾ç½®äºæ¡Œé¢ç¬¬ä¸€ä¸ªç›®æ ‡ä½ç½®åï¼Œå†å°†å…¶æ‹¿èµ·è‡³ç¬¬äºŒä¸ªç›®æ ‡ä½ç½®'

  # Language Instructionï¼ˆè‹±æ–‡ï¼ŒSmolVLAä½¿ç”¨ï¼‰
  # è¿™ä¸ªinstructionä¼šåœ¨æ¯ä¸ªbatchä¸­ä½œä¸ºä»»åŠ¡æ¡ä»¶è¾“å…¥æ¨¡å‹
  # ä¼˜åŒ–ç‰ˆæœ¬ï¼šå¼ºè°ƒå››ä¸ªå…³é”®æ­¥éª¤å’Œä¸­å¿ƒå¯¹é½çº¦æŸ
  language_instruction: 'Step 1: Track and grasp the moving object from the conveyor belt with stable grip at object center. Step 2: Place the object precisely at the CENTER of the first colored target block on the table - ensure object center aligns exactly with target center, avoid edge placement. Step 3: Re-grasp the object securely from the first target position. Step 4: Place the object precisely at the CENTER of the second colored target block - maintain exact center-to-center alignment throughout placement. Critical: All placements must achieve center alignment, not edge or corner placement.'

  # æ•°æ®é…ç½®
  data:
    root: '/root/robot/data/task-1/1-2000/lerobot/'
    # root: '/mnt/e/robot/data/data/task1/lerobot/1-400/'
    repoid: 'lerobot/task1_moving_grasp'
    episodes_to_use: [0, 499]

  # è®­ç»ƒé…ç½®
  training:
    max_epoch: 150 # è§£é”VLMåéœ€è¦æ›´å¤šè®­ç»ƒæ—¶é—´

    # Stage 1: ä»HuggingFaceé¢„è®­ç»ƒSmolVLAå¼€å§‹
    resume_from: 'pretrained'
    pretrained_path: 'lerobot/smolvla_base' # ä½¿ç”¨é•œåƒæºä¸‹è½½çš„é¢„è®­ç»ƒæ¨¡å‹

    # ä¼˜åŒ–å™¨é…ç½®ï¼ˆåˆ†å±‚å­¦ä¹ ç‡ï¼‰
    policy:
      # åŸºç¡€å­¦ä¹ ç‡ï¼ˆç”¨äºå…¶ä»–æ¨¡å—ï¼‰
      optimizer_lr: 1e-5 # é™ä½åŸºç¡€å­¦ä¹ ç‡ï¼Œé¿å…å¿«é€Ÿæ‹Ÿåˆè½¨è¿¹
      # åˆ†å±‚å­¦ä¹ ç‡
      vision_encoder_lr: 5e-6 # è§†è§‰ç¼–ç å™¨ä½å­¦ä¹ ç‡
      expert_lr: 2e-5 # Action Experté«˜å­¦ä¹ ç‡
      # è°ƒåº¦å™¨
      scheduler_warmup_steps: 3000 # æ›´é•¿warmup
      scheduler_decay_steps: 35000 # æ›´é•¿è¡°å‡å‘¨æœŸ

      # ğŸ†• ä»»åŠ¡1æ¨èçš„è§†è§‰å±‚å†»ç»“ç­–ç•¥ï¼ˆä¿å®ˆç­–ç•¥ï¼‰
      # ç›®æ ‡ï¼šå¿«é€Ÿæ”¶æ•›ï¼Œå……åˆ†åˆ©ç”¨é¢„è®­ç»ƒçŸ¥è¯†
      # ç­–ç•¥ï¼šåªè§£å†»æœ€å9å±‚ï¼ˆé«˜å±‚ä»»åŠ¡ç‰¹å®šç‰¹å¾ï¼‰
      unfreeze_vision_layers: [-1, -2, -3, -4, -5, -6, -7, -8, -9] # è§£å†» Layer 18-26


      # ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªç­–ç•¥ï¼Ÿ
      # 1. ä»»åŠ¡1ä»é¢„è®­ç»ƒå¼€å§‹ï¼Œåº•å±‚å’Œä¸­å±‚ç‰¹å¾å·²ç»å¾ˆå¥½
      # 2. ç§»åŠ¨ç›®æ ‡æŠ“å–éœ€è¦é€‚åº”"è¿åŠ¨ç‰©ä½“"ï¼Œåªéœ€è°ƒæ•´é«˜å±‚åŠ¨ä½œå…³è”
      # 3. ä¿å®ˆç­–ç•¥å¯ä»¥é˜²æ­¢è¿‡æ‹Ÿåˆï¼Œæé«˜æ³›åŒ–èƒ½åŠ›
      # 4. é€‚åˆ500 episodesçš„æ•°æ®é‡

      # å¦‚æœæ•ˆæœä¸ä½³ï¼Œå¯ä»¥å°è¯•ï¼š
      # æ›´æ¿€è¿›: unfreeze_vision_layers: [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26]
      # æ›´ä¿å®ˆ: unfreeze_vision_layers: [-1, -2, -3, -4, -5]  # åªè§£å†»æœ€å5å±‚
# ä»»åŠ¡1æ²¡æœ‰replayé…ç½®ï¼ˆå› ä¸ºæ˜¯ç¬¬ä¸€ä¸ªä»»åŠ¡ï¼‰
